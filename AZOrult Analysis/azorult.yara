rule Malware : Azorult
    {
            meta:
                    author = "Dipendra Kushwah"
                    date = "2021-08-27"
                    description = "Match first two bytes for file indentification and strings, Azorult"
                    reference = "https://www.proofpoint.com/us/threat-insight/post/new-version-azorult-stealer-improves-loading-features-spreads-alongside"
					reference = "https://otx.alienvault.com/indicator/file/b72ba2dd844b6e99088093d22a5110ca4bdbd99922d17ef58403b6e389189c8e/"
                    
            strings:
                    $mz = {4D 5A}                 
                    $string2 = "SYSInfo.txt"
                    $string3 = "CookieList.txt"
                    $string4 = "PasswordsList.txt"
					$string5 = "http://ravor.ac.ug"
					$string6 = "%s\\Ethereum\\keystore"
					$string7 = "%S\\r\\nUSER:"
					$string8 = "%s\\r\\nPASS:"
					$string9 = "wininet.dll"
					$string1 = "ST234LMUV56CklAopq78Brstuvwxyz01NOPQRmGHIJKWXYZabcdefgDEFhijn9+/" wide ascii // Azorult custom base64-like alphabet //analyszed for other samples
                    $constant1 = {85 C0 74 40 85 D2 74 31 53 56 57 89 C6 89 D7 8B 4F FC 57} // Azorult grabs .txt and .dat files from Desktop //analyszed for other samples
                    $constant2 = {68 ?? ?? ?? ?? FF 75 FC 68 ?? ?? ?? ?? 8D 45 F8 BA 03 00} // Portion of code from Azorult self-delete function //analyszed for other samples
            condition:
                    $mz at 0 or $string2 or ($string3 and $string4 and $string9) or $string1 or $string5 or $string6 or $string7 or $string8  or ( $constant1 and $constant2 )

    }